<md-toolbar class='header' color="primary">

  <span class='app-heading'>Reddit Playlist Generator</span>

<md-progress-bar *ngIf='showProgressBar' color='accent' class="app-progress" mode="indeterminate"></md-progress-bar>
<span class="app-toolbar-filler"></span>
<div class='spotify-header-section'>
  <a md-button color='accent' *ngIf="!isSpotifyAuthenticated" href='/auth/spotify'>Login to Spotify</a>
  <div *ngIf="spotifyUser" class='spotify-logged-in-status'>Welcome {{ spotifyUser.display_name }}</div>
  <img class='spotify-image' *ngIf="spotifyUser" height='40px' width='40px' src='{{spotifyUser.images[0]?.url}}'/>
</div>
</md-toolbar>

<div class='spotify-header-mobile'>
  <a md-button color='accent' *ngIf="!isSpotifyAuthenticated" href='/auth/spotify'>Login to Spotify</a>
  <div *ngIf="spotifyUser" class='spotify-logged-in-status'>Welcome {{ spotifyUser.display_name }}</div>
  <img class='spotify-image' *ngIf="spotifyUser" height='40px' width='40px' src='{{spotifyUser.images[0]?.url}}'/>
</div>

<div  class='subreddit-options' layout='row' layout-fill layout-margin layout-align='start center'>
  <md-select ngDefaultControl name='genreSelect' [disabled]="!isSpotifyAuthenticated" placeholder='Choose Genre' class='subreddit-select genre-select' [(ngModel)]="genre" (ngModelChange)="onGenreChange($event)">
    <md-option class='subreddit-option' *ngFor="let gen of genres"
      [selected]="gen == genre" [value]="gen">
     {{ gen }}
    </md-option>
  </md-select>
  <md-select ngDefaultControl name='subredditSelect' [disabled]="!isSpotifyAuthenticated" placeholder='Choose Subreddit' class='subreddit-select' [(ngModel)]="subreddit" (ngModelChange)="onChange($event)">
    <md-option class='subreddit-option' *ngFor="let sub of subredditList"
      [selected]="sub == subreddit" [value]="sub">
     {{ sub }}
    </md-option>
  </md-select>
  <md-select ngDefaultControl name='categorySelect' placeholder='Choose Category' class='subreddit-select post-category-select' [(ngModel)]="category" (ngModelChange)="onChange($event)">
    <md-option class='subreddit-option' *ngFor="let cat of subredditCategories"
      [selected]="cat == category" [value]="cat">
     {{ cat }}
    </md-option>
  </md-select>
  <md-select ngDefaultControl name='countSelect' placeholder='Choose Size' class='subreddit-select post-count-select' [(ngModel)]="subredditPostCount" (ngModelChange)="onChange($event)">
    <md-option class='subreddit-option' *ngFor="let count of subredditPostCounts"
      [selected]="count == subredditPostCount" [value]="count">
     {{ count }}
    </md-option>
  </md-select>
</div>

<button md-raised-button class='create-playlist' color="primary"  *ngIf='songs.length' (click)='createPlaylist()' >Create Playlist</button>

<br>

<md-card class='about-card'>
  <h3>Welcome to Reddit Playlist Generator</h3>

  <p>There are tons of genre specific music subreddits out there where users post links to their favorite songs. This app attempts to parse those posts and create playlists on spotify for you. At the moment the functionality is pretty basic. It attempts to parse posts based on the common format of <i>artist - song</i> and finding the most popular match on Spotify. Future plans include more advanced parsing logic, fuzzy search, links to purchase the artist's music (i.e. bandcamp) and connectivity with other streaming services. </p>

  <h4>How to use this app</h4>

  <b>Step 1</b>: Login to spotify by clicking the button on the top right.

  <br>

  <b>Step 2</b>: Select a subreddit from the dropdown. It will fetch the posts from the subreddit and display them in the Reddit Details tab below. It will also search spotify for the songs. You can see information about the found songs in the Spotify Details tab.
    <br>
    <b>Step 3</b>: Click the create playlist button. it will automatically create a public playlist in your spotify account for you.

</md-card>

<br>

<md-card class='status-card'>
  <md-tab-group [selectedIndex]="1">
    <md-tab label="Summary">
      <h3>Summary Info</h3>
      <span>Nothing to see here yet</span>
    </md-tab>
    <md-tab label="Reddit Details">
      <h3>Reddit Post Details</h3>
      <div *ngIf='posts'>
        <md-list class='list'>
          <md-list-item class='list-item' *ngFor="let post of posts">{{post}}</md-list-item>
        </md-list>
      </div>
    </md-tab>
    <md-tab label="Spotify Details">
      <h3>Spotify Details</h3>
      <div *ngIf='songs.length'>
        <md-list class='list'>
          <md-list-item class='list-item' *ngFor="let song of songs"><a href={{song.external_urls.spotify}}>{{song.artists[0].name}} - {{song.name}} - {{song.album.name}}</a></md-list-item>
        </md-list>
      </div>
    </md-tab>
  </md-tab-group>
</md-card>
